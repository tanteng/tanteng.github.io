<!DOCTYPE html>
<html lang="en-us">
    
    


    <head>
    <link href="https://gmpg.org/xfn/11" rel="profile">
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta http-equiv="Cache-Control" content="public" />
<!-- Enable responsiveness on mobile devices -->
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="generator" content="Hugo 0.55.6" />

    
    
    

<title>提交PHP组件到Packagist 发布自己的Composer包 • 小谈博客</title>


<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="提交PHP组件到Packagist 发布自己的Composer包"/>
<meta name="twitter:description" content="Composer是PHP的一个依赖管理工具，它使得PHP焕发新的生机，有了现代化的WEB开发规范，Packagist是PHP组件的库，也有其他的镜像。

在Packagist上提交了一个自己开发的PHP组件，这样其他开发者就可以使用Composer使用这个包了。这个组件并没什么功能，主要是看看提交PHP组件的流程，并记录了过程中遇到的问题及解决方法，以供参考。"/>

<meta property="og:title" content="提交PHP组件到Packagist 发布自己的Composer包" />
<meta property="og:description" content="Composer是PHP的一个依赖管理工具，它使得PHP焕发新的生机，有了现代化的WEB开发规范，Packagist是PHP组件的库，也有其他的镜像。

在Packagist上提交了一个自己开发的PHP组件，这样其他开发者就可以使用Composer使用这个包了。这个组件并没什么功能，主要是看看提交PHP组件的流程，并记录了过程中遇到的问题及解决方法，以供参考。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://tanteng.me/2016/07/submit-composer-packagist/" />
<meta property="article:published_time" content="2016-07-13T04:04:53&#43;00:00"/>
<meta property="article:modified_time" content="2016-07-13T04:04:53&#43;00:00"/>


    


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">








<link rel="stylesheet" href="/scss/hyde-hyde.5908340ec0d0531feb30d45d7ab9a057fcd461f5bda26b1c817b70b1565424bb.css" integrity="sha256-WQg0DsDQUx/rMNRdermgV/zUYfW9omscgXtwsVZUJLs=">


<link rel="stylesheet" href="/scss/print.2744dcbf8a0b2e74f8a50e4b34e5f441be7cf93cc7de27029121c6a09f9e77bc.css" integrity="sha256-J0Tcv4oLLnT4pQ5LNOX0Qb58&#43;TzH3icCkSHGoJ&#43;ed7w=" media="print">



    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <!-- Icons -->
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
    <link rel="shortcut icon" href="/favicon.png">
    
</head>


    <body class=" ">
    
<div class="sidebar">
  <div class="container ">
    <div class="sidebar-about">
      <span class="site__title">
        <a href="https://tanteng.me/">小谈博客</a>
      </span>
      
        
        
        
        <div class="author-image">
          <img src="https://tanteng.me/img/avatar.jpeg" alt="Author Image" class="img--circle img--headshot element--center">
        </div>
        
      
      
      <p class="site__description">
         一个专注 WEB 技术的博客 
      </p>
    </div>
    <div class="collapsible-menu">
      <input type="checkbox" id="menuToggle">
      <label for="menuToggle">小谈博客</label>
      <div class="menu-content">
        <div>
	<ul class="sidebar-nav">
		 
		
		</li>
	</ul>
</div>

        <section class="social">
	
	
	<a href="https://facebook.com/tanteng001" rel="me"><i class="fab fa-facebook-f"></i></a>
	
	
	<a href="https://github.com/tanteng" rel="me"><i class="fab fa-github fa-lg" aria-hidden="true"></i></a>
	
	
	
	
	
	
	<a href="https://instagram.com/tanteng1031" rel="me"><i class="fab fa-instagram fa-lg" aria-hidden="true"></i></a>
	
	
	<a href="https://linkedin.com/in/tanteng" rel="me"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a>
	
	
	
	
	
	
	
	
</section>

      </div>
    </div>
    
<div class="copyright">
  &copy; 2019 TonyTan
  
</div>



  </div>
</div>

        <div class="content container">
            
    
<article>
  <header>
    <h1>提交PHP组件到Packagist 发布自己的Composer包</h1>
    
    
<div class="post__meta">
    
    
      <i class="fas fa-calendar-alt"></i> Jul 13, 2016
    
    
    
      
      
          in
          
          
              <a class="badge badge-category" href="/categories/develop">DEVELOP</a>
              •
          
              <a class="badge badge-category" href="/categories/php">PHP</a>
              
          
      
    
    
    
    <br/>
    <i class="fas fa-clock"></i> 3 min read
</div>


  </header>
  
  
  <div class="post">
    <p>Composer是PHP的一个依赖管理工具，它使得PHP焕发新的生机，有了现代化的WEB开发规范，Packagist是PHP组件的库，也有其他的镜像。</p>

<p>在Packagist上提交了一个自己开发的PHP组件，这样其他开发者就可以使用Composer使用这个包了。这个组件并没什么功能，主要是看看提交PHP组件的流程，并记录了过程中遇到的问题及解决方法，以供参考。</p>

<h3 id="提交php组件步骤">提交PHP组件步骤：</h3>

<p>1.新建一个项目目录，创建一个composer.json文件，格式如下：</p>

<p><code class="lang:php decode:true ">{
    &ldquo;name&rdquo;: &ldquo;your-vendor-name/package-name&rdquo;,
    &ldquo;description&rdquo;: &ldquo;A short description of what your package does&rdquo;,
    &ldquo;require&rdquo;: {
        &ldquo;php&rdquo;: &ldquo;^5.3.3 || ^7.0&rdquo;,
        &ldquo;another-vendor/package&rdquo;: &ldquo;1.*&rdquo;
    }
}</code></p>

<p>这个json格式的文件中包含组件的基本信息，这里还差自动加载的方式，要根据具体开发模式指定自动加载方式，这里require可以指定这个组件依赖的其他组件，composer都会自动解决依赖。</p>

<p>附上完整的composer.json内容作为示例：</p>

<p><code class="lang:js decode:true ">{
    &ldquo;name&rdquo;: &ldquo;tanteng/laravel-page-loaded-time&rdquo;,
    &ldquo;description&rdquo;: &ldquo;Display page loaded time&rdquo;,
    &ldquo;keywords&rdquo;: [&ldquo;laravel&rdquo;,&ldquo;performance&rdquo;],
    &ldquo;homepage&rdquo;: &ldquo;<a href="https://github.com/tanteng/laravel-page-loaded-time&quot;">https://github.com/tanteng/laravel-page-loaded-time&quot;</a>,
    &ldquo;license&rdquo;: &ldquo;MIT&rdquo;,
    &ldquo;authors&rdquo;: [
      {
        &ldquo;name&rdquo;: &ldquo;tanteng&rdquo;,
        &ldquo;email&rdquo;: &ldquo;tanteng@qq.com&rdquo;,
        &ldquo;homepage&rdquo;: &ldquo;<a href="https://www.tanteng.me&quot;">https://www.tanteng.me&quot;</a>,
        &ldquo;role&rdquo;: &ldquo;Developer&rdquo;
      }
    ],
    &ldquo;require&rdquo;: {
        &ldquo;php&rdquo;: &ldquo;^5.3.3 || ^7.0&rdquo;,
        &ldquo;laravel/framework&rdquo;: &ldquo;~4.0&rdquo;
    },
    &ldquo;autoload&rdquo;: {
      &ldquo;psr-4&rdquo;: { &ldquo;Loading\&ldquo;: &ldquo;&rdquo; }
    }
}</code></p>

<p>2.开发组件功能</p>

<p>要注意遵循psr规范，使用命名空间。</p>

<p>3.把组件提交到Github上</p>

<p>提交组件到Packagist之前需要先把代码提交到github上，在Packagist只需填写组件的github地址。</p>

<p>4.提交组件地址到Packagist</p>

<p>这样就完成的PHP组件提交到Packagist的过程，具体请参见Packagist官网。</p>

<h3 id="问题-使用composer-require找不到组件">问题：使用composer require找不到组件</h3>

<p>组件提交到Packagist上，提示发布成功了，但是使用composer命令却找不到组件：</p>

<p><code>composer require tanteng/laravel-page-loaded-time</code></p>

<p>如图：</p>

<p><img class="alignnone size-full wp-image-10231" src="https://blog.tanteng.me/wp-content/uploads/2016/07/composer-not-found.png" alt="composer-not-found" width="699" height="168" /></p>

<p>由于我的composer使用的国内镜像，猜测可能是没有同步的原因，使用这个命令把“源”改回去还是不行。</p>

<p><code>composer config -g repo.packagist composer <a href="https://packagist.org">https://packagist.org</a></code></p>

<p><strong>原来我的组件还没有在github上发布正式，这个时候还是开发版本<span class="version-number">dev-master</span>.应该加上dev-master版本。</strong></p>

<p><code>composer require tanteng/laravel-page-loaded-time:dev-master</code></p>

<p>果然指定了dev-master版本可以成功更新组件，但是这样不行，我们要有一个正式版本。</p>

<p><img class="alignnone size-full wp-image-10234" src="https://blog.tanteng.me/wp-content/uploads/2016/07/composer-dev-master.png" alt="composer-dev-master" width="680" height="307" /></p>

<h3 id="github发布版本">github发布版本</h3>

<p>进入组件的github主页，找到导航上“releases”，点击进去如图页面，就可以创建一个版本，填写好信息之后即可发布版本。</p>

<p><img class="alignnone size-full wp-image-10225" src="https://blog.tanteng.me/wp-content/uploads/2016/07/create_release.png" alt="create_release" width="800" height="386" /></p>

<p>按照页面上的提示填写内容，完成后发布。发布版本后，通过composer require发现还是找不到包。</p>

<h3 id="设置自动更新版本">设置自动更新版本</h3>

<p><img class="alignnone size-full wp-image-10232" src="https://blog.tanteng.me/wp-content/uploads/2016/07/auto-update.png" alt="auto-update" width="735" height="365" /></p>

<p>原来还要在Github上配置一下自动更新。具体步骤参考：<a href="https://packagist.org/about#how-to-update-packages" target="_blank" rel="nofollow"><a href="https://packagist.org/about#how-to-update-packages">https://packagist.org/about#how-to-update-packages</a></a></p>

<p>我直接通过手动的方式发送curl请求来设置，这样还简单一点，不过这样每次发新的版本都需要这样请求一下：</p>

<p><code class="wrap:true lang:php decode:true ">curl -XPOST -H&rsquo;content-type:application/json&rsquo; &lsquo;<a href="https://packagist.org/api/update-package?username=tanteng&amp;apiToken=secret'">https://packagist.org/api/update-package?username=tanteng&amp;apiToken=secret'</a> -d&rsquo;{&ldquo;repository&rdquo;:{&ldquo;url&rdquo;:&ldquo;<a href="https://github.com/tanteng/laravel-page-loaded-time&quot;}}'">https://github.com/tanteng/laravel-page-loaded-time&quot;}}'</a></code></p>

<p>返回{&#8220;status&#8221;:&#8221;success&#8221;}表示成功。</p>

<p>再打开<a href="https://packagist.org/packages/tanteng/laravel-page-loaded-time" target="_blank" rel="nofollow"><a href="https://packagist.org/packages/tanteng/laravel-page-loaded-time">https://packagist.org/packages/tanteng/laravel-page-loaded-time</a></a>，发现已经是正式版本了。</p>

<p>我用的是composer国内镜像，因为众所周知的原因，连代码仓库也要被墙，我服！等了几个小时再试，这个时候镜像同步更新了，再次输入：composer require tanteng/laravel-page-loaded-time,这个时候可以成功更新了。如图，vendor文件夹下也自动装载了依赖的其他组件。</p>

<p><img class="alignnone size-full wp-image-10242" src="https://blog.tanteng.me/wp-content/uploads/2016/07/success.png" alt="success" width="853" height="276" /></p>

<h3 id="有用的链接">有用的链接</h3>

<ul>
<li><a href="http://pkg.phpcomposer.com/" target="_blank" rel="nofollow">Packagist中国镜像</a></li>
<li><a href="https://packagist.org/" target="_blank" rel="nofollow">Packagist官网</a></li>
</ul>
  </div>
  

<div class="navigation navigation-single">
    
    <a href="/2016/07/jquery-append-options/" class="navigation-prev">
      <i aria-hidden="true" class="fa fa-chevron-left"></i>
      <span class="navigation-tittle">更优雅的jQuery拼接下拉框方式</span>
    </a>
    
    
    <a href="/2016/07/misconf-redis-configured-save-rdb-snapshots/" class="navigation-next">
      <span class="navigation-tittle">解决 Redis 只读不可写的问题</span>
      <i aria-hidden="true" class="fa fa-chevron-right"></i>
    </a>
    
</div>


  

  
    


</article>


        </div>
        
    

<script src="https://cdn.bootcss.com/font-awesome/5.5.0/js/all.min.js"></script>

    
    
        <script src="https://cdn.bootcss.com/highlight.js/9.13.1/highlight.min.js"></script>
        
    
    <script type="text/javascript">
        
        hljs.initHighlightingOnLoad();
    </script>
    




    



    </body>
</html>
